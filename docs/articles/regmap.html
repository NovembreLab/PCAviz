<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Illustration of PCAviz on RegMap data • PCAviz</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">PCAviz</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/NovembreLab/PCAviz">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Illustration of PCAviz on RegMap data</h1>
            
            <h4 class="date">2017-06-11</h4>
          </div>

    
    
<div class="contents">
<p>This vignette illustrates PCAviz for visualizing principal components in the Regmap data set. The first two PCs of the genotype data distinguish geographic origins of the <em>Arabidopsis thaliana</em> samples, although some overlap is evident.</p>
<p>Begin by loading these packages into your R environment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(PCAviz)
<span class="kw">library</span>(cowplot)</code></pre></div>
<div id="load-the-data-and-pca-results" class="section level2">
<h2 class="hasAnchor">
<a href="#load-the-data-and-pca-results" class="anchor"></a>Load the data and PCA results</h2>
<p>Load the RegMap data and the computed PCs, and convert these data to a “pcaviz” object. (We do not include the “region” column.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(regmap)
regmap &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pcaviz.html">pcaviz</a></span>(<span class="dt">dat =</span> regmap[-<span class="dv">10</span>])</code></pre></div>
<p>Print a summary of the RegMap data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(regmap)
<span class="co"># first 4 (of 10) principal components (PCs): </span>
<span class="co"># # statistics are (s.d.,min,median,max)</span>
<span class="co"># # s.d.=sqrt(eigenvalue) </span>
<span class="co">#  variable n    stats                 </span>
<span class="co">#  PC1      1307 (NA,-64.7,+0.307,+104)</span>
<span class="co">#  PC2      1307 (NA,-53.8,-2.38,+112) </span>
<span class="co">#  PC3      1307 (NA,-128,+3.44,+55.8) </span>
<span class="co">#  PC4      1307 (NA,-70.3,-1.4,+74.3) </span>
<span class="co"># categorical variables: </span>
<span class="co">#  variable n    stats                       </span>
<span class="co">#  country  1307 33 levels, largest=SWE (319)</span>
<span class="co"># continuous variables: </span>
<span class="co"># # statistics are (min,median,max) </span>
<span class="co">#  variable         n    stats             </span>
<span class="co">#  median_intensity 1179 (127,526,1.47e+03)</span>
<span class="co">#  latitude         1302 (-37.8,49.5,65.2) </span>
<span class="co">#  longitude        1302 (-123,6.19,175)   </span>
<span class="co"># first 4 (of 6) other variables: </span>
<span class="co">#  variable   n    stats</span>
<span class="co">#  array_id   1307 &lt;NA&gt; </span>
<span class="co">#  ecotype_id 1307 &lt;NA&gt; </span>
<span class="co">#  nativename 1307 &lt;NA&gt; </span>
<span class="co">#  firstname  1307 &lt;NA&gt;</span></code></pre></div>
</div>
<div id="create-visualizations-of-the-regmap-pca-results" class="section level2">
<h2 class="hasAnchor">
<a href="#create-visualizations-of-the-regmap-pca-results" class="anchor"></a>Create visualizations of the RegMap PCA results</h2>
<p>Calling “plot” without specifying any additional options shows the projection of the samples onto the first two PCs, with the samples labeled by the country in which they were found.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(regmap)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="regmap_files/figure-html/unnamed-chunk-5-1.png" alt="&amp;nbsp;" width="576"><p class="caption">
 
</p>
</div>
<p>The group summaries add a lot of clutter to these plots, so we remove them. We also don’t need the legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(regmap,<span class="dt">group =</span> <span class="ot">NULL</span>,<span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="regmap_files/figure-html/unnamed-chunk-6-1.png" alt="&amp;nbsp;" width="576"><p class="caption">
 
</p>
</div>
<p>Next, show the country assignments using different colors and shapes instead of labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(regmap,<span class="dt">draw.points =</span> <span class="ot">TRUE</span>,<span class="dt">group =</span> <span class="ot">NULL</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="regmap_files/figure-html/unnamed-chunk-7-1.png" alt="&amp;nbsp;" width="672"><p class="caption">
 
</p>
</div>
<p>By setting the <code>color</code> argument to “longitude” and “latitude”, these next two plots help us understand the relationship between geography and projection onto the PC embedding.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot1 &lt;-<span class="st"> </span><span class="kw">plot</span>(regmap,<span class="dt">draw.points =</span> <span class="ot">TRUE</span>,<span class="dt">color =</span> <span class="st">"longitude"</span>,<span class="dt">group =</span> <span class="ot">NULL</span>)
plot2 &lt;-<span class="st"> </span><span class="kw">plot</span>(regmap,<span class="dt">draw.points =</span> <span class="ot">TRUE</span>,<span class="dt">color =</span> <span class="st">"latitude"</span>,<span class="dt">group =</span> <span class="ot">NULL</span>)
<span class="kw">plot_grid</span>(plot1,plot2,<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>))</code></pre></div>
<div class="figure" style="text-align: center">
<img src="regmap_files/figure-html/unnamed-chunk-8-1.png" alt="&amp;nbsp;" width="672"><p class="caption">
 
</p>
</div>
<p>Does “median intensity” (this is a technical artifact) explain some variation in the first PC?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(regmap,<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">"PC1"</span>,<span class="st">"median_intensity"</span>),<span class="dt">draw.points =</span> <span class="ot">TRUE</span>,
     <span class="dt">group =</span> <span class="ot">NULL</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="regmap_files/figure-html/unnamed-chunk-9-1.png" alt="&amp;nbsp;" width="672"><p class="caption">
 
</p>
</div>
<p>The <code>plot</code> function can also be used to quickly plot combinations of PCs. This code also illustrates customization of the plotting parameters—in this case, since the plots are small, the default point size is a bit too large.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(regmap,<span class="dt">coords =</span> <span class="kw">paste0</span>(<span class="st">"PC"</span>,<span class="dv">1</span>:<span class="dv">4</span>),<span class="dt">group =</span> <span class="ot">NULL</span>,<span class="dt">draw.points =</span> <span class="ot">TRUE</span>,
     <span class="dt">geom.point.params =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span>,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<div class="figure" style="text-align: center">
<img src="regmap_files/figure-html/unnamed-chunk-10-1.png" alt="&amp;nbsp;" width="672"><p class="caption">
 
</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#load-the-data-and-pca-results">Load the data and PCA results</a></li>
      <li><a href="#create-visualizations-of-the-regmap-pca-results">Create visualizations of the RegMap PCA results</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by John Novembre, Richard Williams, Hossein Pourreza, Yuexi Wang, Peter Carbonetto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
